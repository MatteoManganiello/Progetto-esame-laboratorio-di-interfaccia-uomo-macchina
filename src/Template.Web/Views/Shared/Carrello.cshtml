@section styles {
    <link rel="stylesheet" href="~/css/carrello.css" asp-append-version="true" />
}


<div id="carrello-panel" v-if="showCarrello" class="carrello-modal bg-white border rounded-4 p-3 shadow-lg">
    <div class="d-flex justify-content-end align-items-center mb-3 pb-2 border-bottom">
        <button v-if="carrello && carrello.length > 0" class="btn btn-danger btn-sm fw-bold text-white" v-on:click="carrello = []">
            Svuota Carrello
        </button>
    </div>

    <div v-if="!carrello || carrello.length === 0" class="text-muted small">
        Il carrello è vuoto.
    </div>

    <div v-else class="d-flex flex-column gap-2">
        <div v-for="item in carrello" :key="item.postazione.id"
            class="d-flex justify-content-between align-items-center bg-light p-2 rounded-3 border">
            <div>
                <div class="fw-bold small text-dark">{{ item.postazione.nome }}</div>
                <div class="small text-muted" style="font-size: 0.75rem;">
                    {{ item.postazione.tipo }} <span v-if="item.postazione.tipo === 'Ristorante'">x{{
                        item.numeroPersone }}</span>
                </div>
            </div>
            <div class="d-flex align-items-center gap-2">
                <span class="fw-bold text-primary small">€{{ getPrezzoItem(item) }}</span>
                <button class="btn btn-sm btn-link text-danger p-0" v-on:click="rimuoviDalCarrello(item.postazione.id)">
                    <i class="fa-solid fa-times"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- Moved info cards from Sidebar: show when cart has items -->
    <div v-if="carrello && carrello.length > 0" class="mt-3">
        <div class="alert alert-info border-info border-opacity-25 bg-info bg-opacity-10 rounded-4 d-flex align-items-start mb-3 shadow-sm">
            <i class="fa-solid fa-cart-plus text-info mt-1 me-3"></i>
            <div class="small text-dark opacity-75 lh-sm">
                <strong>Vuoi aggiungere altri prodotti?</strong> Puoi continuare a prenotare altre postazioni o servizi prima di confermare l'ordine.
            </div>
        </div>

        <div class="alert alert-warning border-warning border-opacity-25 bg-warning bg-opacity-10 rounded-4 d-flex align-items-start mb-3 shadow-sm">
            <i class="fa-solid fa-triangle-exclamation text-warning mt-1 me-3"></i>
            <div class="small text-dark opacity-75 lh-sm">
                <strong>Politica di Rimborso:</strong> Non sarà previsto alcun rimborso se la prenotazione non viene disdetta entro <strong>1 ora</strong> dalla conferma.
            </div>
        </div>
    </div>

    <div class="d-flex justify-content-between align-items-center mt-3 pt-1">
        <span class="small fw-bold text-muted">Totale Carrello</span>
        <span class="fw-bold text-primary fs-6">€ {{ getTotaleCarrello() }},00</span>
    </div>
    <div class="d-grid gap-3 mt-3">
        <button class="btn btn-primary btn-sm fw-bold shadow-sm d-flex justify-content-center align-items-center rounded-pill animate__animated animate__pulse animate__faster py-1 px-3"
            v-on:click="confermaPrenotazione" :disabled="loadingBtn">
            <span v-if="loadingBtn" class="spinner-border spinner-border-sm me-2"></span>
            <i v-else class="fa-solid fa-receipt me-2"></i>
            <span v-if="!loadingBtn">
                Conferma ({{ carrello.length }})
            </span>
        </button>
    </div>
</div>
